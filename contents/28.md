### æ­£åˆ™çš„æ¦‚ç‡è§£é‡Š

**å¸¸ç”¨æ­£åˆ™é¡¹**

- L2æ­£åˆ™: $R(w) = ||w||_2^2 = \sum_{j=1}^D w_j^2$
- L1æ­£åˆ™: $R(w) = ||w||_1 = \sum_{j=1}^D |w_j|$
- è¿™é‡Œä»¥L2æ­£åˆ™æ¥è¿›è¡Œæ¦‚ç‡è§£é‡Š

**ä¹‹å‰æŸå¤±å‡½æ•°çš„æ¦‚ç‡è§£é‡Š**

- å½“å‡è®¾æ•°æ®äº§ç”Ÿæ¨¡å‹ä¸º: $y = f(x) + \epsilon, \ \ \ \epsilon \sim N(0, \sigma^2)$
    * $\epsilon$ æ˜¯ä¸€ä¸ªå™ªå£°ï¼Œå‡å€¼æ˜¯0ï¼Œ æ–¹å·®æ˜¯$\sigma^2$
- åˆ™ $y | x \sim N(f(x;w), \sigma^2)$, å³ $p(y|x) = \frac{1}{\sqrt{2 \pi} \sigma} exp(- \frac{(y-f(x;w))^2}{2 \sigma^2})$
    * è¿™å°±æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°
    * æ¯ä¸ªæ•°æ®ç‚¹çš„æ¦‚ç‡çŸ¥é“äº†ï¼Œå°±å¯ä»¥æ±‚ä¼¼ç„¶å‡½æ•°
- ä¼¼ç„¶å‡½æ•°ä¸º $p(D|w) = \prod_{i=1}^N \frac{1}{\sqrt{2\pi} \sigma} exp(- \frac{(y_i - f(x_i; w))^2}{2 \sigma^2})$
    * Dæ˜¯è®­ç»ƒæ•°æ®ï¼Œæœ‰Nä¸ªæ ·æœ¬

**æ­£æ€åˆ†å¸ƒå…ˆéªŒ**

- å¢åŠ å‚æ•°çš„å…ˆéªŒ: $w_j$çš„å€¼ä¸èƒ½å¤ªå¤§, $w_j$ å–0é™„è¿‘çš„å€¼æ¦‚ç‡æ›´é«˜ï¼Œè¶Šè¿œç¦»0æ¦‚ç‡è¶Šå°

<div align="center">
    <img width="400" src="./screenshot/4.33.jpg">
</div>

- å¯ç”¨æ­£æ€åˆ†å¸ƒ: $w_j \sim N(0, \tau^2)$
- åˆ™$w_j$ç‹¬ç«‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º: $p(w_j) = \frac{1}{\sqrt{2\pi} \tau} exp(- \frac{w_j^2}{2\tau^2})$
- å‡è®¾$w_j$ç‹¬ç«‹ï¼Œå¾—åˆ°å‘é‡wçš„æ¦‚ç‡å¯†åº¦å‡½æ•°: $p(w) = \prod_{j=1}^D p(w_j)$
- æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œå‚æ•°çš„`åéªŒåˆ†å¸ƒ`ä¸º: $p(w|D) \varpropto p(w) p(D|w)$

**è´å¶æ–¯ä¼°è®¡**

- ä¼¼ç„¶å‡½æ•°ä¸ºï¼š$p(D|w) = \prod_{i=1}^N p(y_i| x_i) = \prod_{i=1}^N \frac{1}{\sqrt{2\pi}\sigma} exp(-\frac{(y_i - f(x_i;w))^2}{2 \sigma^2})$
- å‚æ•°çš„å…ˆéªŒä¸ºï¼š$p(w) = \prod_{i=1}^D p(w_j) = \prod_{j=1}^D \frac{1}{\sqrt{2\pi}\tau} exp(-\frac{w_j^2}{2 \tau^2})$
- å‚æ•°çš„åéªŒåˆ†å¸ƒä¸ºï¼š$p(w|D) \varpropto p(w) p(D|w)$
- ä¸¤è¾¹å–logè¿ç®—ï¼Œå¾—åˆ°ï¼š

$$
log p(w|D) = log p(w) + log p(D|w) \\
= - \frac{D}{2} log(2 \pi) - D log \tau - \sum_{j=1}^D \frac{w_j^2}{2 \tau^2}
$$

- æœ€ç»ˆå¾—åˆ° $log p(w|D) = - \frac{N}{2} log(2 \pi) - Nlog \sigma - \sum_{i=1}^N \frac{(y_i - f(x_i; w))^2}{2 \sigma^2}$

- è´å¶æ–¯æœ€å¤§åéªŒä¼°è®¡(Maximum a posteriori estimation, MAP)ä¸º

$$
\hat{w} = \underset{w}{argmax} log p(w | D) \\
= \underset{w}{argmax} (logp(w) + logp(D|w)) \\
= \underset{w}{argmin} (\sum_{j=1}^D \frac{w_j^2}{2 \tau^2} + \sum_{i=1}^N \frac{(y_i - f(x_i;w))^2}{2 \sigma^2}) \\
= \underset{w}{argmin} (\frac{\sigma^2}{\tau^2} \sum_{j=1}^D w_j^2 + \sum_{i=1}^N (y_i - f(x_i; w))^2) \\
$$

- ä¸Šé¢å»æ‰ä¸ğ°æ— å…³çš„é¡¹ï¼Œå»æ‰è´Ÿå·ï¼Œæœ€å¤§å˜æˆæœ€å°ï¼Œ å¹¶ä¸”ä¹˜ä»¥ $2 \sigma^2$
-  ç­‰ä»·äºå²­å›å½’çš„ç›®æ ‡å‡½æ•° : (L2æ­£åˆ™ç­‰ä»·äºæ­£æ€åˆ†å¸ƒå…ˆéªŒ) $J(w, \lambda) = \sum_{i=1}^N (y_i - f(x_i; w))^2 + \lambda \sum_{j=1}^D w_j^2$
- åŒç†å¯æ¨åˆ°L1æ­£åˆ™ï¼Œç­‰ä»·äºLaplaceåˆ†å¸ƒå…ˆéªŒ $p(w_j) = Laplace(0, b) = \frac{1}{2b}exp(- \frac{|w_j|}{b})$

<div align="center">
    <img width="400" src="./screenshot/4.34.jpg">
</div>

- å½“bä¸åŒçš„æ—¶å€™ï¼Œæ§åˆ¶äº†$w_j$åœ¨0çš„æ¦‚ç‡æœ‰å¤šå¤§