### æœ€å°äºŒä¹˜çº¿æ€§å›å½’

- æœ€å°äºŒä¹˜(OLS)çº¿æ€§å›å½’ä¸­ï¼Œç›®æ ‡å‡½æ•°åªè€ƒè™‘äº†æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆç¨‹åº¦: $J(w) = \sum_{i=1}^N L(y_i, f(x_i, w)) = \sum_{i=1}^N (y_i - f(x_i;w))^2 = ||y-Xw||_2^2$
    * è¿™é‡ŒæŸå¤±å–çš„æ˜¯L2æŸå¤±
- Scikit-Learnä¸­å®ç°çš„æœ€å°äºŒä¹˜çº¿æ€§å›å½’ä¸º:LinearRegression
    * `class sklearn.linear_model.LinearRegression(fit_intercept=True, normalize=False, copy_X=True, n_jobs=1)`
    * $f(x_i;w) = \sum_{j=1}^D w_j x_j + w_0$
    * æŠŠæ¨¡å‹è®­ç»ƒå¥½ä¹‹åï¼Œå‚æ•°ä¼šä¿ç•™åœ¨æ¨¡å‹é‡Œé¢ï¼Œ

<div align="center">
    <img width="600" src="./screenshot/4.30.jpg">
</div>

- å¦‚æœç›®æ ‡å‡½æ•°åªè€ƒè™‘æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆï¼Œä¼šé€‰æ‹©ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡å‹ï¼Œå’Œè®­ç»ƒæ•°æ®æ‹Ÿåˆçš„ç‰¹åˆ«å¥½ï¼Œä½†å’Œæµ‹è¯•æ•°æ®æ‹Ÿåˆçš„å¹¶ä¸å¥½ï¼Œå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚
- æŠ‘åˆ¶è¿‡æ‹Ÿåˆ:åœ¨ç›®æ ‡å‡½æ•°ä¸­åŠ å…¥æ­£åˆ™é¡¹: $J(w,\lambda) = \sum_{i=1}^N L(y_i,f(x_i;w)) +\lambda R(w)$
    * wæ˜¯æ¨¡å‹å‚æ•°ï¼Œ$\lambda$æ˜¯æ­£åˆ™ç³»æ•°
    * è¿™ä¸ªç›®æ ‡å‡½æ•°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼ŒåŠ å·å‰é¢æ˜¯è®­ç»ƒçš„æŸå¤±å’Œï¼Œå«ç»éªŒé£é™©
    * åŠ å·åé¢åªå’Œwæœ‰å…³ç³»ï¼Œå’Œæ¨¡å‹æœ¬èº«å¤æ‚åº¦(æ¨¡å‹ç»“æ„)æœ‰å…³ç³»ï¼ŒRè¡¨ç¤ºRiskçš„æ„æ€ï¼Œè¿™éƒ¨åˆ†é€šå¸¸å«åšç»“æ„é£é™©ï¼Œæ›´å¤šçš„æ—¶å€™æŠŠå‰ååˆèµ·æ¥å«ç»“æ„é£é™©
    * æˆ‘ä»¬æŠŠç›®æ ‡å‡½æ•°æœ€å°åŒ–ï¼Œé€šå¸¸æŒ‡çš„æ˜¯ç»“æ„é£é™©æœ€å°åŒ–
    * è¿™ä¸ª$\lambda$åœ¨æ­£åˆ™é¡¹çš„å‰é¢è¡¨ç¤ºå¯¹è¿™ä¸ªæ­£åˆ™é¡¹æœ‰å¤šçœ‹ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒç§°ä¸ºæ­£åˆ™å‚æ•°ï¼Œ$\lambda$è¶Šå¤§è¡¨ç¤ºæ­£åˆ™$R(w)$ä¸èƒ½å¤ªå¤§, è¿™æ—¶å€™å€¾å‘äºé€‰æ‹©æ¯”è¾ƒç®€å•çš„æ¨¡å‹
    * è¿™ä¸ª$\lambda$å‚æ•°æˆ‘ä»¬æŠŠå®ƒç§°ä¸ºæ¨¡å‹çš„è¶…å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº¤å‰éªŒè¯çš„æ–¹å¼æ‰¾åˆ°åˆé€‚çš„$\lambda$
    * åœ¨è¿™ä¸ªç›®æ ‡å‡½æ•°ä¸­åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯è¦æ±‚æ¨¡å‹å’Œè®­ç»ƒæ•°æ®æ‹Ÿåˆçš„è¾ƒå¥½(èƒ½è§£é‡Šè®­ç»ƒæ•°æ®)ï¼Œå¦ä¸€éƒ¨åˆ†è¦æ±‚æ¨¡å‹ä¸è¦å¤ªå¤æ‚ï¼Œè¿™ä¸ªç›®æ ‡å‡½æ•°ä½“ç°äº†ä¸€ä¸ªå“²å­¦æ€æƒ³: å¥¥å¡å§†å‰ƒåˆ€åŸç†
- å¥¥å¡å§†å‰ƒåˆ€(Occam's Razor)åŸç†:ç®€å•æœ‰æ•ˆï¼Œé€‰æ‹©èƒ½è§£é‡Šæ•°æ®çš„æœ€ç®€å•çš„æ¨¡å‹ã€‚


### å¸¸ç”¨æ­£åˆ™é¡¹

- L2æ­£åˆ™: $R(w) = ||w||_2^2 = \sum_{j=1}^D w_j^2$
- L1æ­£åˆ™: $R(w) = ||w||_1 = \sum_{j=1}^D |w_j|$
- å…¶ä¸­wä¸ºæ¨¡å‹å‚æ•°ï¼Œ Dä¸ºå‚æ•°çš„ç»´æ•°

### å²­å›å½’

- å½“æŸå¤±å‡½æ•°å–L2æŸå¤±: $L(y_i,f(x_i;w)) = (y_i - f(x_i;w))^2$
- æ­£åˆ™é¡¹å–L2æ­£åˆ™: $R(w) = \sum_{i=1}^D w_j^2$ (å¯¹æˆªè·é¡¹ä¸æ–½åŠ æƒ©ç½š)
- æ¨¡å‹å–çº¿æ€§å›å½’: $f(x;w) = w^Tx = \sum_{j=0}^D w_jx_j$ (å¢åŠ å¸¸æ•°é¡¹$x_0 = 1$è¡¨ç¤ºæˆªè·é¡¹)
- å¾—åˆ°å²­å›å½’çš„ç›®æ ‡å‡½æ•°ä¸º:

$$
J(w;\lambda) = \sum_{j=1}^N L(y_i, f(x_i;w)) + \lambda R(w) \\
= \sum_{j=1}^N(y_i - w^T x_i)^2 + \lambda \sum_{j=1}^D w_j^2 \\
= ||y - Xw||_2^2 + \lambda ||w||_2^2
$$

- å²­å›å½’çš„ç›®æ ‡å‡½æ•°ä¸º: $J(w;\lambda) = ||y - Xw||_2^2 + \lambda||w||_2^2$
- Scikit-Learnä¸­å®ç°çš„å²­å›å½’ä¸º: Ridge
    * `class sklearn.linear_model.Ridge(alpha=1.0, fit_intercept=True, normalize=False, copy_X=True, max_iter=None, tol=0.001, solver=â€™autoâ€™, random_state=None)`
    * alpha: ç›®æ ‡å‡½æ•°$J(w; \lambda)$ä¸­çš„$\lambda$
    * fit_interceptã€normalizeã€copy_X: æ„ä¹‰åŒLinearRegression
    * å…¶ä½™å‚æ•°ä¸ä¼˜åŒ–è®¡ç®—æœ‰å…³
    * å±æ€§å’Œå¸¸ç”¨æ–¹æ³•åŒ`LinearRegression`
    * Ridgeä¸­çš„å±æ€§å’Œä¹‹å‰ä¸€æ ·ï¼ŒåŒ…æ‹¬æˆªè·é¡¹$w_0$, å›å½’ç³»æ•°$w_j$
    * å²­å›å½’å’Œ`LinearRegression`çš„ä¸åŒåœ¨äºå¤šäº†ä¸€ä¸ªå‚æ•°alpha, ä¹Ÿå°±æ˜¯æ­£åˆ™å‚æ•°$\lambda$, æ‰€ä»¥å²­å›å½’æ˜¯å¸¦æ­£åˆ™çš„ï¼Œ`LinearRegression`æ˜¯ä¸å¸¦æ­£åˆ™çš„

<div align="center">
    <img width="600" src="./screenshot/4.31.jpg">
</div>

### Lasso

- Lasso æ¨¡å‹ï¼š L2æŸå¤± + L1æ­£åˆ™
- å½“æŸå¤±å‡½æ•°å–L2æŸå¤±ï¼š$L(y_i, f(x_i, w)) = (y_i - f(x_i;w))^2$
- æ­£åˆ™é¡¹å–L1æ­£åˆ™ï¼š$R(w) = \sum_{j=1}^D |w_jx_j|$
- å¾—åˆ°Lasso (Least Absolute Shrinkage and Selection Operator) çš„ç›®æ ‡å‡½æ•°ä¸º
$$
J(w;\lambda) = \sum_{j=1}^N L(y_i, f(x_i; w)) + \lambda R(w) \\
= \sum_{j=1}^N (y_i - w^T x_i)^2 + \lambda \sum_{j=1}^D |w_j| \\
= ||y - Xw||_2^2 + \lambda ||w||_1
$$

- Lasso å›å½’çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š$J(w; \lambda) = ||y - Xw||_2^2 + \lambda ||w||_1$
- Scikit-Learnä¸­å®ç°çš„Lassoä¸ºï¼š$J(w; \lambda) = 1/(2N) ||y - Xw ||_2^2 + \lambda ||w||_1$
    * `class sklearn.linear_model.Lasso(alpha=1.0, fit_intercept=True, normalize=False, precompute=False, copy_X=True, max_iter=1000, tol=0.0001, warm_start=False, positive=False, random_state=None, selection=â€™cyclicâ€™)`
    * alpha: ç›®æ ‡å‡½æ•°ä¸­çš„ $\lambda$
    * fit_interceptã€normalizeã€copy_X: æ„ä¹‰åŒLinearRegression 
    * å…¶ä½™å‚æ•°ä¸ä¼˜åŒ–è®¡ç®—æœ‰å…³
    * å±æ€§å’Œå¸¸ç”¨æ–¹æ³•åŒ`LinearRegression`

<div align="center">
    <img width="600" src="./screenshot/4.32.jpg">
</div>

### å¼¹æ€§ç½‘ç»œ

- å¼¹æ€§ç½‘ç»œ:L2æŸå¤± + (L1æ­£åˆ™ + L2æ­£åˆ™)
- æ­£åˆ™é¡¹è¿˜å¯ä»¥å–L1æ­£åˆ™å’ŒL2æ­£åˆ™çš„ç»„åˆ: $R(w) = \sum_{j=1}^D (\rho |w_j| + \frac{(1-\rho)}{2} w_j^2)$, $\rho$è¡¨ç¤ºL1æ­£åˆ™çš„æ¯”ä¾‹
- å¾—åˆ°å¼¹æ€§ç½‘ç»œçš„ç›®æ ‡å‡½æ•°ä¸º: $J(w; \lambda, \rho) = \frac{1}{2N} ||y - Xw||_2^2 + \lambda(\rho ||w||_1 + \frac{(1-\rho)}{2} ||w||_2^2), \ \  0 \leq \rho \leq 1.$
- Scikit-Learnä¸­å®ç°çš„å¼¹æ€§ç½‘ç»œä¸º:ElasticNet
    * `class sklearn.linear_model.ElasticNet(alpha=1.0, l1_ratio=0.5, fit_intercept=True, normalize=False, precompute=False, max_iter=1000, copy_X=True, tol=0.0001, warm_start=False, positive=False, ra ndom_state=None, selection=â€™cyclicâ€™)`
    * alphaå‚æ•°ä¸ºä¸Šè¿°ç›®æ ‡å‡½æ•°ä¸­çš„ğœ†ï¼Œl1_ratioä¸ºä¸Šè¿°ç›®æ ‡å‡½æ•°ä¸­çš„ğœŒ

### æ­£åˆ™çš„æ•ˆæœ

- ä½¿ç”¨æ­£åˆ™çš„ç›®çš„æ˜¯ä¸ºäº†$w_j$çš„å€¼ä¸è¦å¤ªå¤§ï¼Œä»è€Œä½¿å¾—æ¨¡å‹ä¸ä¼šå¤ªå¤æ‚
- L2æ­£åˆ™ä½¿å¾—çº¿æ€§å›å½’ç³»æ•°æ”¶ç¼©ï¼Œæ¨¡å‹ç¨³å®šã€‚
- å½“è¾“å…¥ç‰¹å¾ä¹‹é—´å­˜åœ¨å…±çº¿æ€§æ—¶ä½¿ç”¨L2æ­£åˆ™ã€‚
- L1æ­£åˆ™ä¹Ÿä¼šæ”¶ç¼©å›å½’ç³»æ•°ã€‚å½“æ­£åˆ™å‚æ•°å–åˆé€‚å€¼æ—¶ï¼ŒL1æ­£åˆ™ä½¿å¾—æœ‰äº›çº¿æ€§å›å½’ç³»æ•°ä¸º0ï¼Œå¾—åˆ°ç¨€ç–æ¨¡å‹ã€‚
- å½“è¾“å…¥ç‰¹å¾å¤šï¼Œæœ‰äº›ç‰¹å¾ä¸ç›®æ ‡å˜é‡ä¹‹é—´ç›¸å…³æ€§å¾ˆå¼±æ—¶ï¼ŒL1æ­£åˆ™å¯èƒ½åªé€‰æ‹©å¼ºç›¸å…³çš„ç‰¹å¾ï¼Œæ¨¡å‹è§£é‡Šæ€§å¥½ã€‚
- æ³¨æ„:ç”±äºæ­£åˆ™é¡¹ä¸­å¯¹ä¸åŒç»´åº¦çš„$w_j$åŒç­‰å¯¹å¾…ï¼Œå¯¹è¾“å…¥ç‰¹å¾Xæœ€å¥½åšå»é‡çº²(scaling)å¤„ç†ï¼Œä½¿å¾—ä¸åŒç»´åº¦çš„ç‰¹å¾å–å€¼èŒƒå›´å¤§è‡´ç›¸åŒã€‚(å¦‚æ ‡å‡†åŒ–:sklearn.preprocessing.StandardScaler )
